elastic-agent-1  | agent container initialisation - effective capabilities
elastic-agent-1  | agent container initialisation - ambient capabilities
elastic-agent-1  | agent container initialisation - chown paths
elastic-agent-1  | Warning: cannot chown agent paths without CAP_CHOWN or CAP_DAC_OVERRIDE capabilities
elastic-agent-1  | Policy selected for enrollment:  b8a70af7-6d8c-4d69-aa35-7a3afdaf5f1e
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:10.688Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/cmd.(*enrollCmd).enrollWithBackoff","file.name":"cmd/enroll_cmd.go","file.line":520},"message":"Starting enrollment to URL: https://fleet-server:8220/","ecs.version":"1.6.0"}
elastic-agent-1  | Successfully enrolled the Elastic Agent.
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.684Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/cmd.(*enrollCmd).Execute","file.name":"cmd/enroll_cmd.go","file.line":305},"message":"Elastic Agent has been enrolled; start Elastic Agent","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.698Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/cmd.runElasticAgent","file.name":"cmd/run.go","file.line":195},"message":"Elastic Agent started","log":{"source":"elastic-agent"},"process.pid":6,"agent.version":"8.17.1","agent.unprivileged":true,"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.917Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/upgrade.InvokeWatcher","file.name":"upgrade/rollback.go","file.line":149},"message":"agent is not upgradable, not starting watcher","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.922Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/cmd.runElasticAgent","file.name":"cmd/run.go","file.line":284},"message":"APM instrumentation disabled","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.927Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application.New","file.name":"application/application.go","file.line":62},"message":"Gathered system information","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.941Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application.New","file.name":"application/application.go","file.line":68},"message":"Detected available inputs and outputs","log":{"source":"elastic-agent"},"inputs":["postgresql/metrics","aws/metrics","cloudfoundry","cometd","http_endpoint","kibana/metrics","tcp","synthetics/http","elasticsearch/metrics","kubernetes/metrics","audit/file_integrity","benchmark","log","syslog","syncgateway/metrics","haproxy/metrics","cloudbeat/cis_aws","aws-cloudwatch","container","synthetics/tcp","osquery","endpoint","mqtt","winlog","enterprisesearch/metrics","uwsgi/metrics","mssql/metrics","cloudbeat/cis_eks","iis/metrics","jolokia/metrics","sql/metrics","stan/metrics","docker","entity-analytics","o365audit","logstash/metrics","cloudbeat/cis_azure","nats/metrics","cloudbeat/asset_inventory_aws","docker/metrics","awsfargate/metrics","containerd/metrics","activemq/metrics","windows/metrics","nginx/metrics","cloud_defend/control","pf-host-agent","aws-s3","azure-blob-storage","zookeeper/metrics","http/metrics","packet","cloudbeat/vuln_mgmt_aws","gcp-pubsub","httpjson","netflow","salesforce","oracle/metrics","apache/metrics","kafka/metrics","cloudbeat/asset_inventory_gcp","azure-eventhub","journald","mysql/metrics","system/metrics","rabbitmq/metrics","statsd/metrics","traefik/metrics","vsphere/metrics","etw","udp","unix","etcd/metrics","fleet-server","meraki/metrics","cloudbeat/cis_k8s","audit/auditd","redis","streaming","synthetics/icmp","panw/metrics","audit/system","filestream","linux/metrics","memcached/metrics","redis/metrics","prometheus/metrics","cloudbeat","cloudbeat/cis_gcp","apm","lumberjack","synthetics/browser","mongodb/metrics","pf-elastic-symbolizer","beat/metrics","azure/metrics","cloudfoundry/metrics","gcp/metrics","pf-elastic-collector","cel","gcs","kafka","cloudbeat/asset_inventory_azure"],"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.942Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","file.name":"capabilities/capabilities.go","file.line":48},"message":"Capabilities file not found in /usr/share/elastic-agent/state/capabilities.yml","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.942Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application.New","file.name":"application/application.go","file.line":74},"message":"Determined allowed capabilities","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.942Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application.New","file.name":"application/application.go","file.line":89},"message":"Loading baseline config from /usr/share/elastic-agent/state/elastic-agent.yml","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:11.994Z","log.origin":{"function":"github.com/elastic/elastic-agent/pkg/component/runtime.NewManager","file.name":"runtime/manager.go","file.line":175},"message":"GRPC comms socket listening at localhost:6789","log":{"source":"elastic-agent"},"address":"localhost:6789","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:12.002Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application.New","file.name":"application/application.go","file.line":159},"message":"Parsed configuration and determined agent is managed by Fleet","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:12.003Z","log.logger":"control","log.origin":{"function":"github.com/elastic/elastic-agent/pkg/control/v2/server.(*Server).Start","file.name":"server/server.go","file.line":88},"message":"GRPC control socket listening at unix:///usr/share/elastic-agent/state/data/Td8I7R-Zby36_zF_IOd9QVNlFblNEro3.sock","log":{"source":"elastic-agent"},"address":"unix:///usr/share/elastic-agent/state/data/Td8I7R-Zby36_zF_IOd9QVNlFblNEro3.sock","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:12.004Z","log.logger":"composable.providers.docker","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/composable/providers/docker.(*dynamicProvider).Run","file.name":"docker/docker.go","file.line":44},"message":"Docker provider skipped, unable to connect: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:12.004Z","log.origin":{"function":"github.com/elastic/elastic-agent/pkg/component/runtime.(*Manager).Run","file.name":"runtime/manager.go","file.line":238},"message":"Starting grpc control protocol listener on port 6789 with max_message_size 104857600","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:12.622Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).Run","file.name":"fleet/fleet_gateway.go","file.line":138},"message":"Fleet gateway started","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:14.341Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*PolicyChangeHandler).applyLoggingConfig","file.name":"handlers/handler_action_policy_change.go","file.line":405},"message":"Setting fallback log level <nil> from policy","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:14.348Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/upgrade.(*Upgrader).Reload","file.name":"upgrade/upgrade.go","file.line":123},"message":"Source URI changed from \"https://artifacts.elastic.co/downloads/\" to \"https://artifacts.elastic.co/downloads/\"","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:14.349Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).refreshComponentModel","file.name":"coordinator/coordinator.go","file.line":1270},"message":"Updating running component model","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:33.019Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*Settings).handleLogLevel","file.name":"handlers/handler_action_settings.go","file.line":80},"message":"Settings action done, setting agent log level to debug","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.019Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":165},"message":"Successfully dispatched action: 'id: 23423c0b-f7f7-4aff-88e5-8a338bdb8283, type: SETTINGS, log_level: debug'","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:33.019Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).checkAndLogUpdate","file.name":"coordinator/coordinator.go","file.line":1477},"message":"component model updated","log":{"source":"elastic-agent"},"changes":{"components":{},"outputs":{}},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:33.020Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).refreshComponentModel","file.name":"coordinator/coordinator.go","file.line":1270},"message":"Updating running component model","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.020Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).refreshComponentModel","file.name":"coordinator/coordinator.go","file.line":1271},"message":"Updating running component model","log":{"source":"elastic-agent"},"components":[],"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.238Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).Run","file.name":"fleet/fleet_gateway.go","file.line":146},"message":"FleetGateway calling Checkin API","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.238Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).doExecute","file.name":"fleet/fleet_gateway.go","file.line":176},"message":"Checking started","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.457Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":295},"message":"using previously saved ack token: 00bc82e9-4a3b-4340-ab6e-02ed90b54349","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.457Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":304},"message":"correcting agent loglevel from debug to debug using coordinator state","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.457Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":172},"message":"Request method: POST, path: /api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin, reqID: 01JJ9KPVTHJMC1RYAH3KZP84SW","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:33.458Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":186},"message":"Creating new request to request URL https://fleet-server:8220/api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.282Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/storage/store.(*StateStore).Save","file.name":"store/state_store.go","file.line":258},"message":"save state on disk : {Version:1 ActionSerializer:{Marshaler:<nil> Unmarshaler:<nil> Action:id: policy:b8a70af7-6d8c-4d69-aa35-7a3afdaf5f1e:1, type: POLICY_CHANGE} AckToken:d8d086c3-763d-4941-be10-7d6c59373145 Queue:[]}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.283Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":126},"message":"Gathered 0 actions from queue, 0 actions expired","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.283Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":127},"message":"Expired actions: []","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.293Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/storage/store.(*StateStore).Save","file.name":"store/state_store.go","file.line":258},"message":"save state on disk : {Version:1 ActionSerializer:{Marshaler:<nil> Unmarshaler:<nil> Action:id: policy:b8a70af7-6d8c-4d69-aa35-7a3afdaf5f1e:1, type: POLICY_CHANGE} AckToken:d8d086c3-763d-4941-be10-7d6c59373145 Queue:[]}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.293Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":141},"message":"Dispatch 1 actions of types: *fleetapi.ActionPolicyReassign","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.293Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*PolicyReassign).Handle","file.name":"handlers/handler_action_policy_reassign.go","file.line":29},"message":"handlerPolicyReassign: action 'id: f4950126-6eea-4abc-bf53-fbc90c510eae, type: POLICY_REASSIGN' received","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/lazy.(*Acker).enqueue","file.name":"lazy/lazy_acker.go","file.line":126},"message":"appending action with id 'f4950126-6eea-4abc-bf53-fbc90c510eae' to the queue","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/storage/store.(*StateStore).SetAction","file.name":"store/state_store.go","file.line":197},"message":"trying to set invalid action type on the state store, ignoring the action","log":{"source":"elastic-agent"},"action.type":"POLICY_REASSIGN","action.id":"f4950126-6eea-4abc-bf53-fbc90c510eae","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/lazy.(*Acker).Commit","file.name":"lazy/lazy_acker.go","file.line":83},"message":"lazy acker: ack batch: [id: f4950126-6eea-4abc-bf53-fbc90c510eae, type: POLICY_REASSIGN]","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":81},"message":"fleet acker: ackbatch, actions: []fleetapi.Action{(*fleetapi.ActionPolicyReassign)(0xc000d119e0)}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":99},"message":"fleet acker: ackbatch, events: []fleetapi.AckEvent{fleetapi.AckEvent{EventType:\"ACTION_RESULT\", SubType:\"ACKNOWLEDGED\", Timestamp:\"2025-01-23T12:55:34.2941+00:00\", ActionID:\"f4950126-6eea-4abc-bf53-fbc90c510eae\", AgentID:\"6e7f07fa-276e-4b46-afee-93cb40b42dc5\", Message:\"Action \\\"f4950126-6eea-4abc-bf53-fbc90c510eae\\\" of type \\\"POLICY_REASSIGN\\\" acknowledged.\", Payload:json.RawMessage(nil), Data:json.RawMessage(nil), ActionInputType:\"\", ActionData:json.RawMessage(nil), ActionResponse:map[string]interface {}(nil), StartedAt:\"\", CompletedAt:\"\", Error:\"\"}}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":110},"message":"1 actions with ids 'f4950126-6eea-4abc-bf53-fbc90c510eae' acknowledging","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":172},"message":"Request method: POST, path: /api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/acks, reqID: 01JJ9KPWMPVY0PFY67809R8QRS","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:34.294Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":186},"message":"Creating new request to request URL https://fleet-server:8220/api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/acks?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.073Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":165},"message":"Successfully dispatched action: 'id: f4950126-6eea-4abc-bf53-fbc90c510eae, type: POLICY_REASSIGN'","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.720Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).Run","file.name":"fleet/fleet_gateway.go","file.line":146},"message":"FleetGateway calling Checkin API","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.721Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).doExecute","file.name":"fleet/fleet_gateway.go","file.line":176},"message":"Checking started","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.934Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":295},"message":"using previously saved ack token: d8d086c3-763d-4941-be10-7d6c59373145","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.935Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":304},"message":"correcting agent loglevel from debug to debug using coordinator state","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.935Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":172},"message":"Request method: POST, path: /api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin, reqID: 01JJ9KPY7Z8HGT9F88Q737YTZV","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:35.935Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":186},"message":"Creating new request to request URL https://fleet-server:8220/api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.001Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":126},"message":"Gathered 0 actions from queue, 0 actions expired","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.001Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":127},"message":"Expired actions: []","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/storage/store.(*StateStore).Save","file.name":"store/state_store.go","file.line":258},"message":"save state on disk : {Version:1 ActionSerializer:{Marshaler:<nil> Unmarshaler:<nil> Action:id: policy:b8a70af7-6d8c-4d69-aa35-7a3afdaf5f1e:1, type: POLICY_CHANGE} AckToken:d8d086c3-763d-4941-be10-7d6c59373145 Queue:[]}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":141},"message":"Dispatch 1 actions of types: *fleetapi.ActionPolicyChange","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*PolicyChangeHandler).Handle","file.name":"handlers/handler_action_policy_change.go","file.line":90},"message":"handlerPolicyChange: action 'id: policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2, type: POLICY_CHANGE' received","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*PolicyChangeHandler).Handle","file.name":"handlers/handler_action_policy_change.go","file.line":114},"message":"handlerPolicyChange: emit configuration for action id: policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2, type: POLICY_CHANGE","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*PolicyChangeHandler).applyLoggingConfig","file.name":"handlers/handler_action_policy_change.go","file.line":405},"message":"Setting fallback log level <nil> from policy","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.008Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/actions/handlers.(*Settings).SetLogLevel","file.name":"handlers/handler_action_settings.go","file.line":105},"message":"received fallback loglevel <nil>, raw loglevel debug","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.016Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/dispatcher.(*ActionDispatcher).Dispatch","file.name":"dispatcher/dispatcher.go","file.line":165},"message":"Successfully dispatched action: 'id: policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2, type: POLICY_CHANGE'","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.017Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/upgrade.(*Upgrader).Reload","file.name":"upgrade/upgrade.go","file.line":123},"message":"Source URI changed from \"https://artifacts.elastic.co/downloads/\" to \"https://artifacts.elastic.co/downloads/\"","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.018Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).checkAndLogUpdate","file.name":"coordinator/coordinator.go","file.line":1477},"message":"component model updated","log":{"source":"elastic-agent"},"changes":{"components":{"added":["filestream-default"],"count":1},"outputs":{"added":["elasticsearch"]}},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.018Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).refreshComponentModel","file.name":"coordinator/coordinator.go","file.line":1270},"message":"Updating running component model","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.018Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).refreshComponentModel","file.name":"coordinator/coordinator.go","file.line":1271},"message":"Updating running component model","log":{"source":"elastic-agent"},"components":[{"ID":"filestream-default","InputType":"filestream","OutputType":"elasticsearch","Units":[{"ID":"filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c"},{"ID":"filestream-default"}]}],"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.018Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/lazy.(*Acker).enqueue","file.name":"lazy/lazy_acker.go","file.line":126},"message":"appending action with id 'policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2' to the queue","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/storage/store.(*StateStore).Save","file.name":"store/state_store.go","file.line":258},"message":"save state on disk : {Version:1 ActionSerializer:{Marshaler:<nil> Unmarshaler:<nil> Action:id: policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2, type: POLICY_CHANGE} AckToken:d8d086c3-763d-4941-be10-7d6c59373145 Queue:[]}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/lazy.(*Acker).Commit","file.name":"lazy/lazy_acker.go","file.line":83},"message":"lazy acker: ack batch: [id: policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2, type: POLICY_CHANGE]","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":81},"message":"fleet acker: ackbatch, actions: []fleetapi.Action{(*fleetapi.ActionPolicyChange)(0xc000c73c80)}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":99},"message":"fleet acker: ackbatch, events: []fleetapi.AckEvent{fleetapi.AckEvent{EventType:\"ACTION_RESULT\", SubType:\"ACKNOWLEDGED\", Timestamp:\"2025-01-23T12:55:38.02545+00:00\", ActionID:\"policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2\", AgentID:\"6e7f07fa-276e-4b46-afee-93cb40b42dc5\", Message:\"Action \\\"policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2\\\" of type \\\"POLICY_CHANGE\\\" acknowledged.\", Payload:json.RawMessage(nil), Data:json.RawMessage(nil), ActionInputType:\"\", ActionData:json.RawMessage(nil), ActionResponse:map[string]interface {}(nil), StartedAt:\"\", CompletedAt:\"\", Error:\"\"}}","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/fleetapi/acker/fleet.(*Acker).AckBatch","file.name":"fleet/fleet_acker.go","file.line":110},"message":"1 actions with ids 'policy:f6187843-4e3a-46e9-a3f0-0c28289d0933:2' acknowledging","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":172},"message":"Request method: POST, path: /api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/acks, reqID: 01JJ9KQ099QTX2ECFDHNKZ4B7Y","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.025Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":186},"message":"Creating new request to request URL https://fleet-server:8220/api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/acks?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:38.144Z","log.origin":{"function":"github.com/elastic/elastic-agent/pkg/component/runtime.(*Manager).update","file.name":"runtime/manager.go","file.line":823},"message":"Starting component \"filestream-default\"","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.145Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":625},"message":"Spawned new component filestream-default: Starting: spawned pid '362'","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.145Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":632},"message":"Spawned new unit filestream-default: Starting: spawned pid '362'","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"STARTING"},"unit":{"id":"filestream-default","type":"output","state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.145Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":632},"message":"Spawned new unit filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c: Starting: spawned pid '362'","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"STARTING"},"unit":{"id":"filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c","type":"input","state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.308Z","message":"Home path: [/usr/share/elastic-agent/data/elastic-agent-b46c28/components] Config path: [/usr/share/elastic-agent/data/elastic-agent-b46c28/components] Data path: [/usr/share/elastic-agent/state/data/run/filestream-default] Logs path: [/usr/share/elastic-agent/data/elastic-agent-b46c28/components/logs]","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":1062,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.309Z","message":"Beat ID: 758b6464-e4a1-4150-a820-103771c9fca3","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":1070,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.311Z","message":"Output reload is enabled, the beat will restart as needed on change of output config","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"ecs.version":"1.6.0","log.logger":"centralmgmt","log.origin":{"file.line":204,"file.name":"management/managerV2.go","function":"github.com/elastic/beats/v7/x-pack/libbeat/management.NewV2AgentManagerWithClient"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.311Z","message":"Set gc percentage to: 100","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":1124,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.313Z","message":"running under elastic-agent, per-beat lockfiles disabled","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":673,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.313Z","message":"Starting stats endpoint","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"api","log.origin":{"file.line":69,"file.name":"api/server.go","function":"github.com/elastic/beats/v7/libbeat/api.(*Server).Start"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.314Z","message":"Syscall filter successfully installed","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"seccomp","log.origin":{"file.line":125,"file.name":"seccomp/seccomp.go","function":"github.com/elastic/beats/v7/libbeat/common/seccomp.loadFilter"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.314Z","message":"Setup Beat: filebeat; Version: 8.17.1","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"beat","log.origin":{"file.line":570,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).createBeater"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.314Z","message":"Output is configured through Central Management","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":603,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).createBeater"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.314Z","message":"Metrics endpoint listening on: /usr/share/elastic-agent/state/data/tmp/7uyxrneW50ZMk_CZbrE0Hjg3idmd7AzZ.sock (configured: unix:///usr/share/elastic-agent/state/data/tmp/7uyxrneW50ZMk_CZbrE0Hjg3idmd7AzZ.sock)","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"api","log.origin":{"file.line":71,"file.name":"api/server.go","function":"github.com/elastic/beats/v7/libbeat/api.(*Server).Start.func1"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.316Z","message":"Beat name: elastic-agent-47249","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"publisher","log.origin":{"file.line":105,"file.name":"pipeline/module.go","function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.LoadWithSettings"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.316Z","message":"Enabled modules/filesets: ","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"modules","log.origin":{"file.line":136,"file.name":"fileset/modules.go","function":"github.com/elastic/beats/v7/filebeat/fileset.newModuleRegistry"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.316Z","message":"Starting metrics logging every 30s","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"monitoring","log.origin":{"file.line":150,"file.name":"log/log.go","function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).snapshotLoop"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.317Z","message":"filebeat start running.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":770,"file.name":"instance/beat.go","function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.318Z","message":"Finished loading transaction log file for '/usr/share/elastic-agent/state/data/run/filestream-default/registry/filebeat'. Active transaction id=0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":134,"file.name":"memlog/store.go","function":"github.com/elastic/beats/v7/libbeat/statestore/backend/memlog.openStore"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"warn","@timestamp":"2025-01-23T12:55:38.318Z","message":"Filebeat is unable to load the ingest pipelines for the configured modules because the Elasticsearch output is not configured/enabled. If you have already loaded the ingest pipelines or are using Logstash pipelines, you can ignore this warning.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":361,"file.name":"beater/filebeat.go","function":"github.com/elastic/beats/v7/filebeat/beater.(*Filebeat).Run"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.318Z","message":"States Loaded from registrar: 0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":107,"file.name":"registrar/registrar.go","function":"github.com/elastic/beats/v7/filebeat/registrar.(*Registrar).loadStates"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"registrar","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.318Z","message":"Loading Inputs: 0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"crawler","log.origin":{"file.line":71,"file.name":"beater/crawler.go","function":"github.com/elastic/beats/v7/filebeat/beater.(*crawler).Start"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.318Z","message":"Loading and starting Inputs completed. Enabled inputs: 0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"crawler","log.origin":{"file.line":106,"file.name":"beater/crawler.go","function":"github.com/elastic/beats/v7/filebeat/beater.(*crawler).Start"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.323Z","log.logger":"component.runtime.filestream-default","log.origin":{"function":"github.com/elastic/elastic-agent/pkg/component/runtime.(*Manager).CheckinV2","file.name":"runtime/manager.go","file.line":704},"message":"control checkin v2 protocol has chunking enabled","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.324Z","message":"BeatV2Manager.unitListen UnitChanged.ID(filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c), UnitChanged.Type(added), UnitChanged.Trigger(4): added/feature_change_triggered","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"centralmgmt.V2-manager","log.origin":{"file.line":506,"file.name":"management/managerV2.go","function":"github.com/elastic/beats/v7/x-pack/libbeat/management.(*BeatV2Manager).unitListen"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.324Z","message":"BeatV2Manager.unitListen UnitChanged.ID(filestream-default), UnitChanged.Type(added), UnitChanged.Trigger(4): added/feature_change_triggered","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"centralmgmt.V2-manager","log.origin":{"file.line":506,"file.name":"management/managerV2.go","function":"github.com/elastic/beats/v7/x-pack/libbeat/management.(*BeatV2Manager).unitListen"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:38.996Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":645},"message":"Component state changed filestream-default (STARTING->HEALTHY): Healthy: communicating with pid '362'","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"HEALTHY","old_state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.326Z","message":"Got output unit config ''","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"centralmgmt.V2-manager","log.origin":{"file.line":756,"file.name":"management/managerV2.go","function":"github.com/elastic/beats/v7/x-pack/libbeat/management.(*BeatV2Manager).reloadOutput"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.326Z","message":"Applying performance preset 'latency': {\n  \"bulk_max_size\": 50,\n  \"compression_level\": 1,\n  \"idle_connection_timeout\": \"1m0s\",\n  \"queue\": {\n    \"mem\": {\n      \"events\": 4100,\n      \"flush\": {\n        \"min_events\": 2050,\n        \"timeout\": \"1s\"\n      }\n    }\n  },\n  \"worker\": 1\n}","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"elasticsearch","log.origin":{"file.line":63,"file.name":"elasticsearch/elasticsearch.go","function":"github.com/elastic/beats/v7/libbeat/outputs/elasticsearch.makeES"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"warn","@timestamp":"2025-01-23T12:55:39.327Z","message":"Performance preset 'latency' overrides user setting for field 'bulk_max_size'","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"ecs.version":"1.6.0","log.logger":"elasticsearch","log.origin":{"file.line":66,"file.name":"elasticsearch/elasticsearch.go","function":"github.com/elastic/beats/v7/libbeat/outputs/elasticsearch.makeES"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.327Z","message":"elasticsearch url: https://elasticsearch:9200","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":132,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.NewConnection"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.328Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":663},"message":"Unit state changed filestream-default (STARTING->HEALTHY): Healthy","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"HEALTHY"},"unit":{"id":"filestream-default","type":"output","state":"HEALTHY","old_state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.327Z","message":"Unable to reload APM tracing; no APM reloadable registered","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"centralmgmt.V2-manager","log.origin":{"file.line":885,"file.name":"management/managerV2.go","function":"github.com/elastic/beats/v7/x-pack/libbeat/management.(*BeatV2Manager).reloadAPM"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.328Z","message":"Starting reload procedure, current runners: 0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"centralmgmt","log.origin":{"file.line":93,"file.name":"cfgfile/list.go","function":"github.com/elastic/beats/v7/libbeat/cfgfile.(*RunnerList).Reload"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.329Z","message":"Start list: 1, Stop list: 0","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"centralmgmt","log.origin":{"file.line":111,"file.name":"cfgfile/list.go","function":"github.com/elastic/beats/v7/libbeat/cfgfile.(*RunnerList).Reload"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.330Z","message":"recursive glob enabled","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"scanner","log.origin":{"file.line":334,"file.name":"filestream/fswatch.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileScanner).resolveRecursiveGlobs"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.330Z","message":"file identity is set to native","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":58,"file.name":"filestream/prospector_creator.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.newProspector"},"service.name":"filebeat","filestream_id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.330Z","message":"Starting runner: filestream","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"centralmgmt","log.origin":{"file.line":155,"file.name":"cfgfile/list.go","function":"github.com/elastic/beats/v7/libbeat/cfgfile.(*RunnerList).Reload"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.330Z","message":"Runner filestream does not implement DiagnosticRunner, skipping","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":172,"file.name":"cfgfile/list.go","function":"github.com/elastic/beats/v7/libbeat/cfgfile.(*RunnerList).Reload"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"centralmgmt","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.330Z","message":"Input 'filestream' starting","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","ecs.version":"1.6.0","log.logger":"input.filestream","log.origin":{"file.line":135,"file.name":"compat/compat.go","function":"github.com/elastic/beats/v7/filebeat/input/v2/compat.(*runner).Start.func1"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.330Z","message":"registering","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","key":"filestream-postfix_log-72f5937c-c27c-4134-aab3-dc472a484d3c","ecs.version":"1.6.0","log.logger":"metric_registry","log.origin":{"file.line":63,"file.name":"inputmon/input.go","function":"github.com/elastic/beats/v7/libbeat/monitoring/inputmon.NewInputRegistry"},"input_type":"filestream","uuid":"6fe9087f-f5be-488a-9bda-ee683cb39891","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.330Z","message":"Starting prospector","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"prospector":"file_prospector","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","ecs.version":"1.6.0","log.logger":"input.filestream","log.origin":{"file.line":132,"file.name":"filestream/prospector.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileProspector).Run"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.331Z","message":"Start next scan","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"file_watcher","log.origin":{"file.line":125,"file.name":"filestream/fswatch.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileWatcher).watch"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.331Z","message":"File scan complete","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"written":0,"truncated":0,"removed":0,"ecs.version":"1.6.0","log.logger":"file_watcher","total":1,"renamed":0,"created":1,"log.origin":{"file.line":229,"file.name":"filestream/fswatch.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileWatcher).watch"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:39.331Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/coordinator.(*Coordinator).watchRuntimeComponents","file.name":"coordinator/coordinator.go","file.line":663},"message":"Unit state changed filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c (STARTING->HEALTHY): Healthy","log":{"source":"elastic-agent"},"component":{"id":"filestream-default","state":"HEALTHY"},"unit":{"id":"filestream-default-filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c","type":"input","state":"HEALTHY","old_state":"STARTING"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.331Z","message":"A new file /tmp/service_logs/mail.log has been found","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"ecs.version":"1.6.0","log.origin":{"file.line":178,"file.name":"filestream/prospector.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileProspector).onFSEvent"},"prospector":"file_prospector","os_id":"24862-51","new_path":"/tmp/service_logs/mail.log","log.logger":"input.filestream","service.name":"filebeat","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","operation":"create","source_name":"native::24862-51","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.331Z","message":"Starting harvester for file","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","log.logger":"input.filestream","service.name":"filebeat","source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","ecs.version":"1.6.0","log.origin":{"file.line":140,"file.name":"input-logfile/harvester.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream/internal/input-logfile.(*defaultHarvesterGroup).Start"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.332Z","message":"Generated new processors: add_fields={\"@metadata\":{\"input_id\":\"filestream-postfix-72f5937c-c27c-4134-aab3-dc472a484d3c\"}}, add_fields={\"data_stream\":{\"dataset\":\"postfix.log\",\"namespace\":\"44741\",\"type\":\"logs\"}}, add_fields={\"event\":{\"dataset\":\"postfix.log\"}}, add_fields={\"@metadata\":{\"stream_id\":\"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c\"}}, add_fields={\"elastic_agent\":{\"id\":\"6e7f07fa-276e-4b46-afee-93cb40b42dc5\",\"snapshot\":false,\"version\":\"8.17.1\"}}, add_fields={\"agent\":{\"id\":\"6e7f07fa-276e-4b46-afee-93cb40b42dc5\"}}","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"processors","log.origin":{"file.line":114,"file.name":"processors/processor.go","function":"github.com/elastic/beats/v7/libbeat/processors.New"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.333Z","message":"newLogFileReader with config.MaxBytes:10485760","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","ecs.version":"1.6.0","log.origin":{"file.line":208,"file.name":"filestream/input.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*filestream).open"},"path":"/tmp/service_logs/mail.log","state-id":"native::24862-51","log.logger":"input.filestream","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.424Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).Run","file.name":"fleet/fleet_gateway.go","file.line":146},"message":"FleetGateway calling Checkin API","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.424Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).doExecute","file.name":"fleet/fleet_gateway.go","file.line":176},"message":"Checking started","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.634Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":295},"message":"using previously saved ack token: d8d086c3-763d-4941-be10-7d6c59373145","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.634Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/agent/application/gateway/fleet.(*FleetGateway).execute","file.name":"fleet/fleet_gateway.go","file.line":304},"message":"correcting agent loglevel from info to debug using coordinator state","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.634Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":172},"message":"Request method: POST, path: /api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin, reqID: 01JJ9KQ1VJP50EKAAHD2G8Z302","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:39.634Z","log.origin":{"function":"github.com/elastic/elastic-agent/internal/pkg/remote.(*Client).Send","file.name":"remote/client.go","file.line":186},"message":"Creating new request to request URL https://fleet-server:8220/api/fleet/agents/6e7f07fa-276e-4b46-afee-93cb40b42dc5/checkin?","log":{"source":"elastic-agent"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:41.314Z","message":"add_cloud_metadata: timed-out waiting for all responses","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"add_cloud_metadata","log.origin":{"file.line":193,"file.name":"add_cloud_metadata/providers.go","function":"github.com/elastic/beats/v7/libbeat/processors/add_cloud_metadata.(*addCloudMetadata).fetchMetadata"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:41.314Z","message":"add_cloud_metadata: fetchMetadata ran for 3.001664411s","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"add_cloud_metadata","log.origin":{"file.line":150,"file.name":"add_cloud_metadata/providers.go","function":"github.com/elastic/beats/v7/libbeat/processors/add_cloud_metadata.(*addCloudMetadata).fetchMetadata.func1"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:41.314Z","message":"add_cloud_metadata: hosting provider type not detected.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"add_cloud_metadata","log.origin":{"file.line":100,"file.name":"add_cloud_metadata/add_cloud_metadata.go","function":"github.com/elastic/beats/v7/libbeat/processors/add_cloud_metadata.(*addCloudMetadata).init.func1"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:41.320Z","message":"End of file reached: /tmp/service_logs/mail.log; Backoff now.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":131,"file.name":"filestream/filestream.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*logFile).Read"},"id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","path":"/tmp/service_logs/mail.log","state-id":"native::24862-51","log.logger":"input.filestream","service.name":"filebeat","source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:42.315Z","message":"Connecting to backoff(elasticsearch(https://elasticsearch:9200))","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"publisher_pipeline_output","log.origin":{"file.line":138,"file.name":"pipeline/client_worker.go","function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.(*netClientWorker).run"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.315Z","message":"ES Ping(url=https://elasticsearch:9200)","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","log.origin":{"file.line":303,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Ping"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:42.323Z","message":"'ca_trusted_fingerprint' set, looking for matching fingerprints","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"tls","log.origin":{"file.line":180,"file.name":"tlscommon/tls_config.go","function":"github.com/elastic/elastic-agent-libs/transport/tlscommon.trustRootCA"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:42.323Z","message":"CA certificate matching 'ca_trusted_fingerprint' found, adding it to 'certificate_authorities'","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"ecs.version":"1.6.0","log.logger":"tls","log.origin":{"file.line":200,"file.name":"tlscommon/tls_config.go","function":"github.com/elastic/elastic-agent-libs/transport/tlscommon.trustRootCA"},"service.name":"filebeat","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.324Z","message":"Completed dialing successfully","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":43,"file.name":"transport/logging.go","function":"github.com/elastic/elastic-agent-libs/transport/httpcommon.(*HTTPTransportSettings).RoundTripper.LoggingDialer.func2"},"service.name":"filebeat","network.transport":"tcp","server.address":"elasticsearch:9200","log.logger":"esclientleg","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.332Z","message":"Ping status code: 200","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","log.origin":{"file.line":322,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Ping"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:42.332Z","message":"Attempting to connect to Elasticsearch version 8.17.1 (default)","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":323,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Ping"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.332Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.335Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.336Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.337Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.339Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.340Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.341Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.343Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.344Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.346Z","message":"GET https://elasticsearch:9200/_license?human=false  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.347Z","message":"GET https://elasticsearch:9200/  <nil>","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"esclientleg","log.origin":{"file.line":380,"file.name":"eslegclient/connection.go","function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection).Request"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"info","@timestamp":"2025-01-23T12:55:42.348Z","message":"Connection to backoff(elasticsearch(https://elasticsearch:9200)) established","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"publisher_pipeline_output","log.origin":{"file.line":146,"file.name":"pipeline/client_worker.go","function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.(*netClientWorker).run"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.650Z","message":"doBulkRequest: 43 events have been sent to elasticsearch in 301.43058ms.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.origin":{"file.line":301,"file.name":"elasticsearch/client.go","function":"github.com/elastic/beats/v7/libbeat/outputs/elasticsearch.(*Client).doBulkRequest"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"elasticsearch","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.650Z","message":"ackloop: return ack to broker loop:43","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"publisher","log.origin":{"file.line":80,"file.name":"memqueue/ackloop.go","function":"github.com/elastic/beats/v7/libbeat/publisher/queue/memqueue.(*ackLoop).handleBatchSig"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:42.650Z","message":"ackloop:  done send ack","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"publisher","log.origin":{"file.line":82,"file.name":"memqueue/ackloop.go","function":"github.com/elastic/beats/v7/libbeat/publisher/queue/memqueue.(*ackLoop).handleBatchSig"},"service.name":"filebeat","ecs.version":"1.6.0","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:43.322Z","message":"End of file reached: /tmp/service_logs/mail.log; Backoff now.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"input.filestream","log.origin":{"file.line":131,"file.name":"filestream/filestream.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*logFile).Read"},"source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","path":"/tmp/service_logs/mail.log","ecs.version":"1.6.0","service.name":"filebeat","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","state-id":"native::24862-51","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:47.324Z","message":"End of file reached: /tmp/service_logs/mail.log; Backoff now.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"path":"/tmp/service_logs/mail.log","state-id":"native::24862-51","ecs.version":"1.6.0","source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","log.logger":"input.filestream","log.origin":{"file.line":131,"file.name":"filestream/filestream.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*logFile).Read"},"service.name":"filebeat","id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:49.332Z","message":"Start next scan","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","ecs.version":"1.6.0","log.logger":"file_watcher","log.origin":{"file.line":125,"file.name":"filestream/fswatch.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileWatcher).watch"},"ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:49.332Z","message":"File scan complete","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"service.name":"filebeat","renamed":0,"created":0,"log.origin":{"file.line":229,"file.name":"filestream/fswatch.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*fileWatcher).watch"},"total":1,"written":0,"truncated":0,"removed":0,"ecs.version":"1.6.0","log.logger":"file_watcher","ecs.version":"1.6.0"}
elastic-agent-1  | {"log.level":"debug","@timestamp":"2025-01-23T12:55:55.325Z","message":"End of file reached: /tmp/service_logs/mail.log; Backoff now.","component":{"binary":"filebeat","dataset":"elastic_agent.filebeat","id":"filestream-default","type":"filestream"},"log":{"source":"filestream-default"},"log.logger":"input.filestream","service.name":"filebeat","path":"/tmp/service_logs/mail.log","ecs.version":"1.6.0","log.origin":{"file.line":131,"file.name":"filestream/filestream.go","function":"github.com/elastic/beats/v7/filebeat/input/filestream.(*logFile).Read"},"id":"filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c","source_file":"filestream::filestream-postfix.log-72f5937c-c27c-4134-aab3-dc472a484d3c::native::24862-51","state-id":"native::24862-51","ecs.version":"1.6.0"}
